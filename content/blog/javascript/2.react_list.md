---
title: react 면접 주제
date: 2022-01-11
tags: ["javascript"]
publish: false
image: "./javascript.jpg"
---

## 5. 리액트 패키지 구조 (v16.12.0)

1. react 코어

   - react에서 사용되는 컴포넌트와 관련된 패키지
   - React element를 만드는 `createElement()`와 개발자에게 다른 패키지의 모듈을 제공하는 중간 다리 역할

2. renderer

   - 호스트와 react를 연결하는 역할을 하는 패키지
   - react-dom

3. reconciler

   - react 동작의 핵심 패키지
   - VDOM과 관련
   - v15 이전이 스택 기반이었다면 v16 이후부터는 `fiber 구조` 도입

4. scheduler

   - 리액트의 비동기 실행기

5. event
   - 개발자가 event를 사용하기 전 리액트에서 추가적인 제어를 하기 위해 호스트 event를 wrapping하여 작동된다

### 5.1 리액트 패키지 구동 순서

    (1) 컴포넌트 호출은 reconciler 패키지에서 한다.
    (2) 이후 VDOM이 전후 관계를 비교 후
    (3) rederer 패키지에서 실제 DOM에 마운트한다.

### 5.2 관련 용어 정리

- reactElement : 컴포넌트의 정보를 담은 객체로, 컴포넌트가 반환하는 것이 React Element이다.
- fiber : VDOM의 노드 객체로, 이 객체는 VDOM에서 React Element를 활용하기 위해 React Element를 확장시킨 객체이다.

  - fiber라는 객체를 통해 컴포넌트의 상태값, 훅 api, 리액트 라이프 사이클의 구현이 가능해진다.

### 5.3 VDOM

- VDOM은 fiber(=VDOM 노드)객체로 이루어져있다.
- 하나의 노드로 `현재 트리`와 `업데이트될 트리`를 관리한다.
- 돔이 실제로 마운트된 현재 트리와 VDOM에서 재조정 중인 업데이트 준비 트리로 나뉜다. 이 업데이트 준비 트리는 리액트 라이프사이클에서 `commit phase`라는 시점에 현재 트리로 관리된다.
- 업데이트될 트리는 현재 트리를 자기 복제해 참조하는 식으로 만들어진다.
- fiber(=VDOM 노드)구조는 자식을 child로 참조하는데 자식들 중 첫번째 자식만 참조한다.
  - 나머지 자식들은 첫번째 자식의 sibling 형태로 참조한다.

### 5.4 React Element

- jsx는 바벨을 통해 React Element라는 컴포넌트 정보를 담고 있는 객체로 변환된다.

### 5.5 Side Effect

- VDOM에 변경점을 만들어내는 작업
- 리액트에서 사용되는 side effect tag들이 존재
- fiber(=VDOM 노드)에 특정 태그가 붙으면 리액트 내부에서 effect로 취급돼 변경될 리스트의 상위에 위치한다.
- 부모 자식 컴포넌트 각각에 태그가 붙으면 자식 fiber 순서대로 리스트가 나열돼 리액트 라이프 사이클에서 `commit phase`라는 시점에 소비된다.

## 6. 리액트 훅 동작 원리

### 6.1 리액트 훅 구현체

```js
// react > ReactCurrentDispatcher.js
const ReactCurrentDispatcher = {
  current: null,
}

export default ReactCurrentDispatcher
```

리액트 훅 구현체는 current 값만 갖고 있는 빈 객체이다. 이 빈 객체가 활용되기 위해서는
VDOM 역할을 하는 reconciler 패키지에서 훅이 주입되어야한다. 그런데 바로 주입되진 않고 shared 패키지라는 공통 폴더 역할을 하는 곳을 통로를 이용해 주입된다.

reconciler -> shared/ReactSharedInternal -> react/ReactSharedInternal -> react/ReactCurrentDispatcher -> react/ReactHooks -> react -> 개발자

### 6.2 리액트 훅 구현체 주입

```js
// reconciler > ReactFiberHooks.js
export function renderWithHooks(
  current: Fiber,
  workInProgress: Fiber,
  Component: any,
  props: any,
  refOrContext: any,
  nextRenderExpirationTime: ExpirationTime
) {
  /*...*/
  currentlyRenderingFiber = workInProgress // 현재 작업 중인 fiber를 전역으로 잡아둠
  nextCurrentHook = current !== null ? current.memoizedState : null

  ReactCurrentDispatcher.current =
    nextCurrentHook === null ? HooksDispatcherOnMount : HooksDispatcherOnUpdate

  let children = Component(props, refOrContext)

  /*컴포넌트 재호출 로직..*/

  const renderedWork = currentlyRenderingFiber
  renderedWork.memoizedState = firstWorkInProgressHook

  ReactCurrentDispatcher.current = ContextOnlyDispatcher

  currentlyRenderingFiber = null
  /*...*/
}
```

- 리액트 훅을 이용해 상태가 변경되어 컴포넌트가 호출되어야 할 때 훅리스트가 생성된다. 훅리스트라는 변수는 fiber(=VDOM 노드)에 memoizedState로 저장되어 훅이 컴포넌트와 매핑되도록 해 준다.
- fiber(=VDOM 노드)에 memoizedState가 null인 경우 마운트 상태가 아니고, null이 아닌 경우 마운트 상태로 확인해 그에 맞게 훅 구현체에 변경된 상태 정보가 주입된다.

### 6.3 리액트 훅은 어떻게 생성되는가

- 훅 구현체에는 마운트용 구현체와 업데이트용 구현체가 존재한다.
- 처음 컴포넌트가 마운트될 때 실행되는 훅의 경우 마운트 구현체로 객체가 생성이 된다.
- 하나의 컴포넌트에서 훅을 이용해 여러개의 상태 변경이 일어난 경우 업데이트 객체로 생성이 되어 훅의 큐에 저장된다.
- 이후 컴포넌트가 리-랜더링이될 때 큐에 저장되어있던 훅 객체들이 차례로 실행돼 최종 상태값들을 만든다.

### 6.4 리액트 훅은 어떻게 상태를 변경하고 컴포넌트를 리랜더링하는가

reconciler 패키지에 존재하는 **dispatchAction 함수를 이용해 훅 상태를 업데이트한다**

1. 업데이트된 정보가 담긴 훅 객체 생성
2. 훅 객체를 훅 큐에 저장
3. 불필요한 렌더링 최적화
4. 컴포넌트 변경을 돔에 적용하는 작업을 스케줄링한다
   - 작업 스케쥴링이 진행될 때 해당 fiber(=VDOM 노드)에 expirationTime이 새겨진다. (중복 스케줄링 방지)

- dispatchAction 함수는 컴포넌트를 재호출하는 작업을 딱 한 번만 스케줄한다. 최종 상태 정보들이 훅 객체에 저장되었다가 `render phase`에서 한 번에 소비된다.
- 컴포넌트 재호출 시점에 추가로 발생한 setState는 이전과 묶여서 1번으로 실행된다.

## 리액트를 왜 사용하나요

## Virtual Dom에 대해서 아나요

## setState의 경우 동기로 동작하나요 비동기로 동작하나요?

## useMemo와 useCallback의 차이가 뭔가요

## 리듀서 내부에서 불변성을 유지하기 위해 얕은 복사를 사용하나요 깊은 복사를 사용하나요

## 리덕스의 기본 원칙은

## 리덕스를 사용하신다고 하셨는데, Flux 패턴에 대해서 알고 있나요

## 본인이 생각하는 리덕스 thunk 와 saga의 차이가 뭔가요

## 리덕스 toolkit 차이

## 리덕스

## react 18 신기능 알아보기

## react-query 준비

## 리액트 사용시에 부수효과로 인해 생기는 문제점이 있다면

## 컴포넌트의 라이프 사이클 메서드

## SPA가 뭔가요?🔥

- SPA의 단점

## SSR이 뭔가요

## EO가 뭔가요
