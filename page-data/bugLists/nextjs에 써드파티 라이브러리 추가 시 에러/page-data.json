{
    "componentChunkName": "component---src-templates-blog-post-js",
    "path": "/bugLists/nextjs에 써드파티 라이브러리 추가 시 에러/",
    "result": {"data":{"site":{"siteMetadata":{"title":"ksy8230.github.io"}},"markdownRemark":{"id":"1bf27e92-f932-5510-829d-30d07f897830","excerpt":"에러 환경 npm v.8.1.2 node v.16.13.2 에러 현상 Nextjs 기반의 프로젝트 작업 중 팀 내부에서 자주 쓰는 모듈들만 모아둔 써드파티 라이브러리를 추가하려니 설치가 안 됐다. 에러 원인 이 라이브러리들이 CRA…","html":"<h2 id=\"에러-환경\" style=\"position:relative;\">에러 환경<a href=\"#%EC%97%90%EB%9F%AC-%ED%99%98%EA%B2%BD\" aria-label=\"에러 환경 permalink\" class=\"custom-class after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>npm v.8.1.2<br>\nnode v.16.13.2</p>\n<h2 id=\"에러-현상\" style=\"position:relative;\">에러 현상<a href=\"#%EC%97%90%EB%9F%AC-%ED%98%84%EC%83%81\" aria-label=\"에러 현상 permalink\" class=\"custom-class after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>Nextjs 기반의 프로젝트 작업 중 팀 내부에서 자주 쓰는 모듈들만 모아둔 써드파티 라이브러리를 추가하려니 설치가 안 됐다.</p>\n<h2 id=\"에러-원인\" style=\"position:relative;\">에러 원인<a href=\"#%EC%97%90%EB%9F%AC-%EC%9B%90%EC%9D%B8\" aria-label=\"에러 원인 permalink\" class=\"custom-class after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>이 라이브러리들이 CRA 기반의 프로젝트 기준으로 작업되었던 모듈들이라는 점을 시작으로 CRA와 Nextjs의 외부 모듈 설치 시 어떤 차이점이 있는지 찾아보았다. 그리고 이 과정에서 CRA와 Nextjs가 외부 모듈을 받아들이는 포맷이 다르다는 걸 알게 되었다.<br>\n프론트 개발자끼리 사용하려고 예쁘게 정리해둔 모듈들을 <a href=\"https://rollupjs.org/guide/en/\">rollup.js</a>을 이용해 빌드시킨 후 <a href=\"https://verdaccio.org/\">verdaccio</a>에 배포를 한 뒤 필요한 프로젝트에 추가하는 식으로 사용을 하는데\r\n여태까지 esm 형식으로 CRA에 추가해 왔던 것이 Nextjs에서는 인식이 안 되었던 것이다. Nextjs는 cjs, 즉 common js로만 패키지 모듈을 인식하고 있었다.<br>\n빌드 파일의 용량을 줄이겠다고 컴포넌트를 개발할 때 가능하면 <code class=\"language-text\">(라이브러리명)/esm/locale.js</code> 이런 식으로 범위를 좁혀서 import 시킨 뒤 배포를 했는데 import 구문이 esm 형식이라 cjs 포맷만 받는 프로젝트에서는 에러를 뿜었던 것이다.</p>\n<h2 id=\"해결-방법\" style=\"position:relative;\">해결 방법<a href=\"#%ED%95%B4%EA%B2%B0-%EB%B0%A9%EB%B2%95\" aria-label=\"해결 방법 permalink\" class=\"custom-class after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>esm 포맷으로 불러오는 구문들을 제거하여 배포하니 잘 동작한다.<br>\n그런데 정말 Nextjs에서 esm 형식의 포맷을 가져올 방법이 없는걸까? cjs, esm 둘다 설치가 가능한 방안을 찾아봐야겠다.</p>","frontmatter":{"title":"nextjs에 써드파티 라이브러리 추가 시 에러","date":"2022-09-14","description":null,"tags":["버그리포트"]},"tableOfContents":"<ul>\n<li><a href=\"#%EC%97%90%EB%9F%AC-%ED%99%98%EA%B2%BD\">에러 환경</a></li>\n<li><a href=\"#%EC%97%90%EB%9F%AC-%ED%98%84%EC%83%81\">에러 현상</a></li>\n<li><a href=\"#%EC%97%90%EB%9F%AC-%EC%9B%90%EC%9D%B8\">에러 원인</a></li>\n<li><a href=\"#%ED%95%B4%EA%B2%B0-%EB%B0%A9%EB%B2%95\">해결 방법</a></li>\n</ul>"},"previous":{"fields":{"slug":"/nextjs/Nextjs/"},"frontmatter":{"title":"NextJS API 공부 - 동적 페이지 서버사이드 렌더링 작업 (getStaticPaths, getStaticProps)"}},"next":{"fields":{"slug":"/review/2022/"},"frontmatter":{"title":"2022 회고"}}},"pageContext":{"id":"1bf27e92-f932-5510-829d-30d07f897830","previousPostId":"55ba5a1e-95cf-52dc-bade-0f12320e60f0","nextPostId":"a9e4fe9a-9572-5f3b-9095-cd51be615d0b"}},
    "staticQueryHashes": ["1414085880","2841359383"]}